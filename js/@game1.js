/**********************************************************************
 require( 'require' )
 -----------------------------------------------------------------------
 @example

 var Path = require("node://path");  // Only in NodeJS/NW.js environment.
 var Button = require("tfw.button");

 **********************************************************************/

window.require = function() {
    var modules = {};
    var definitions = {};
    var nodejs_require = typeof window.require === 'function' ? window.require : null;

    var f = function(id, body) {
        if( id.substr( 0, 7 ) == 'node://' ) {
            // Calling for a NodeJS module.
            if( !nodejs_require ) {
                throw Error( "[require] NodeJS is not available to load module `" + id + "`!" );
            }
            return nodejs_require( id.substr( 7 ) );
        }

        if( typeof body === 'function' ) {
            definitions[id] = body;
            return;
        }
        var mod;
        body = definitions[id];
        if (typeof body === 'undefined') {
            var err = new Error("Required module is missing: " + id);   
            console.error(err.stack);
            throw err;
        }
        mod = modules[id];
        if (typeof mod === 'undefined') {
            mod = {exports: {}};
            var exports = mod.exports;
            body(f, mod, exports);
            modules[id] = mod.exports;
            mod = mod.exports;
            //console.log("Module initialized: " + id);
        }
        return mod;
    };
    return f;
}();
function addListener(e,l) {
    if (window.addEventListener) {
        window.addEventListener(e,l,false);
    } else {
        window.attachEvent('on' + e, l);
    }
};

addListener(
    'DOMContentLoaded',
    function() {
        document.body.parentNode.$data = {};
        // Attach controllers.
        var W = require('x-widget');
        W('game10', 'game1', {"fullscreen": "true"},{"id":"game10","name":"game1"})

    }
);
<<<<<<< HEAD
require("$",function(r,t,n){n.config={name:'"tolo-fast-sprite"',description:'"Low-level versatile yet powerfull library to paint sprites on WebGL context"',author:'"tolokoban"',version:'"0.0.8"',major:"0",minor:"0",revision:"8",date:"2017-12-14T12:51:33.000Z",consts:{}};var o=null;n.lang=function(r){return void 0===r&&(window.localStorage&&(r=window.localStorage.getItem("Language")),r||(r=window.navigator.language)||(r=window.navigator.browserLanguage)||(r="fr"),r=r.substr(0,2).toLowerCase()),o=r,window.localStorage&&window.localStorage.setItem("Language",r),r},n.intl=function(r,t){var o,e,a,i,l,g,s,u=r[n.lang()],w=t[0];for(s in r)break;if(!s)return w;if(!u&&!(u=r[s]))return w;if(o=u[w],o||(u=r[s],o=u[w]),!o)return w;if(t.length>1){for(e="",l=0,a=0;a<o.length;a++)i=o.charAt(a),"$"===i?(e+=o.substring(l,a),a++,g=o.charCodeAt(a)-48,g<0||g>=t.length?e+="$"+o.charAt(a):e+=t[g],l=a+1):"\\"===i&&(e+=o.substring(l,a),a++,e+=o.charAt(a),l=a+1);e+=o.substr(l),o=e}return o}});
=======
require("$",function(r,t,n){n.config={name:'"tolo-fast-sprite"',description:'"Low-level versatile yet powerfull library to paint sprites on WebGL context"',author:'"tolokoban"',version:'"0.0.7"',major:"0",minor:"0",revision:"7",date:"2017-09-23T14:23:04.000Z",consts:{}};var o=null;n.lang=function(r){return void 0===r&&(window.localStorage&&(r=window.localStorage.getItem("Language")),r||(r=window.navigator.language)||(r=window.navigator.browserLanguage)||(r="fr"),r=r.substr(0,2).toLowerCase()),o=r,window.localStorage&&window.localStorage.setItem("Language",r),r},n.intl=function(r,t){var o,e,a,i,l,g,s,u=r[n.lang()],w=t[0];for(s in r)break;if(!s)return w;if(!u&&!(u=r[s]))return w;if(o=u[w],o||(u=r[s],o=u[w]),!o)return w;if(t.length>1){for(e="",l=0,a=0;a<o.length;a++)i=o.charAt(a),"$"===i?(e+=o.substring(l,a),a++,g=o.charCodeAt(a)-48,g<0||g>=t.length?e+="$"+o.charAt(a):e+=t[g],l=a+1):"\\"===i&&(e+=o.substring(l,a),a++,e+=o.charAt(a),l=a+1);e+=o.substr(l),o=e}return o}});
>>>>>>> dc2365dbc72900a85b369c3324c4a408d0d177b1
//# sourceMappingURL=$.js.map
require("game1",function(e,t,i){function a(e){var t=this._gl,i=new o(t,this.resolution,e);t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ZERO,t.ONE),t.blendEquation(t.FUNC_ADD),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL);var a=function(e){if(requestAnimationFrame(a),-1===i.lastTime)return i.baseTime=e,i.lastTime=e,void i.setNextSequence("BuildLevel");i.time=e-i.baseTime,i.delta=e-i.lastTime,i.lastTime=e,i.absoluteTime=e,p.loop(i.time,i.delta),i.sequence(i)};requestAnimationFrame(a)}var n=function(){function t(){return a(i,arguments)}var i={en:{},fr:{}},a=e("$").intl;return t.all=i,t}();e("game1.gfx");var s=e("dom"),l=e("tfw.data-binding"),r=(e("tfw.message").info,e("splash")),o=(e("webgl.resize"),e("game1.runtime")),p=e("game1.controls"),u=function(e){var t=r({atlas:"css/game1.gfx/qbert.png"}),i=s.elem(this,"canvas");console.info("Creation of context for WebGL 2.0");var n=i.getContext("webgl2",{alpha:!1,depth:!0,stencil:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,failIfPerformanceCaveat:!1});n||(console.warn("Fallback to WebGL 1.0"),n=i.getContext("webgl",{alpha:!1,depth:!0,stencil:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,failIfPerformanceCaveat:!1})),this._gl=n,l.propRemoveClass(this,"visible","hide"),l.prop(this,"width")(function(e){isNaN(parseInt(e))||(e+="px"),s.css(i,{width:e})}),l.prop(this,"height")(function(e){isNaN(parseInt(e))||(e+="px"),s.css(i,{height:e})}),l.propInteger(this,"resolution"),l.propAddClass(this,"fullscreen"),e=l.extend({visible:!0,fullscreen:!1,resolution:1,width:"100%",height:"100%"},e,this);var o=this;t.then(function(e){a.call(o,e.atlas)})};t.exports=u,t.exports._=n});
//# sourceMappingURL=game1.js.map
require("game1.controls",function(e,n,t){function r(e){var n=e.key,t=i[n];return console.info("[controls] key=",n,t),t&&e.preventDefault(),t}var a=function(){function n(){return r(t,arguments)}var t={en:{},fr:{}},r=e("$").intl;return n.all=t,n}(),o={NE:0,SE:0,SW:0,NW:0,R:0,L:0,U:0,D:0},i={9:"NE",5:"NE",3:"SE",2:"SE",1:"SW",7:"NW",4:"NW",ArrowLeft:"NW",ArrowUp:"NE",ArrowRight:"SE",ArrowDown:"SW"},c=[];for(var u in o)c.push(u);c.forEach(function(e){Object.defineProperty(n.exports,e,{set:function(){},get:function(){return o[e]||0},enumerable:!0,configurable:!1})}),document.addEventListener("keydown",function(e){var n=r(e);n&&(o[n]=1)}),document.addEventListener("keyup",function(e){var n=r(e);n&&(o[n]=0)}),n.exports.loop=function(e,n){var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[];if(t){var r=t[0];if(r){var a=r.axes[0],i=r.axes[1];o.NE=o.NW=o.SE=o.SW=0,Math.abs(a)<.001||Math.abs(i)<.001||(a>0?i>0?o.SE=1:o.NE=1:i>0?o.SW=1:o.NW=1)}}},window.addEventListener("gamepadconnected",function(e){console.info("[controls] e.gamepad=",e.gamepad)}),n.exports._=a});
//# sourceMappingURL=game1.controls.js.map
require("game1.runtime",function(e,t,i){function n(e,t,i){this.levelIndex=0,this.level=null,this.gl=e,this.resolution=t,this.atlas=i,this.playground=s(e,i),this.legend=s(e,i),this.hero=null,this.monsters=null,this.absoluteTime=0,this.baseTime=0,this.lastTime=-1,this.time=0,this.delta=0,this.sequence=null,this.context={}}function s(e,t){return new u({gl:e,atlas:t,cellSrcW:.25,cellSrcH:.25,cellDstW:128,cellDstH:128})}var l=function(){function t(){return n(i,arguments)}var i={en:{},fr:{}},n=e("$").intl;return t.all=i,t}(),u=e("webgl.fast-sprite"),o={BuildLevel:e("game1.sequence.buildlevel"),PlayTime:e("game1.sequence.playtime")};n.prototype.setNextSequence=function(e){var t=o[e];if("function"!=typeof t)throw Error("Unknown sequence name: "+e);console.log("Next sequence: ",e),this.sequence=t,this.baseTime=this.absoluteTime,this.deltaTime=0,this.time=0,"function"==typeof t.init&&t.init(this)},t.exports=n,t.exports._=l});
//# sourceMappingURL=game1.runtime.js.map
require("game1.sequence.playtime",function(e,n,t){function r(e){var n=e.gl,t=e.playground,r=(e.legend,e.time),i=e.hero,l=e.monsters,m=e.level,c=(e.resolution,Math.min(n.canvas.width,n.canvas.height)/700),f=c;if(i.play(e),l.forEach(function(n){n.play(e)}),m.monsters.length>0){var g=m.monsters[0];g.birth<r&&(m.monsters.shift(),l.push(new s(g.col,g.row,m,t,g.duration,i,function(){o("Miam, miam! You're dead..."),e.setNextSequence("BuildLevel")})))}u.paint(e,c,f),m.isDone()&&(a("Congratulation!!"),e.levelIndex++,e.setNextSequence("BuildLevel"))}var i=function(){function n(){return r(t,arguments)}var t={en:{},fr:{}},r=e("$").intl;return n.all=t,n}(),o=e("tfw.message").error,a=e("tfw.message").info,s=e("game1.jumper.monster"),u=e("game1.sequence");r.init=function(e){e.hero.fireMove()},n.exports=r,n.exports._=i});
//# sourceMappingURL=game1.sequence.playtime.js.map
require("game1.sequence",function(e,n,r){var t=function(){function n(){return t(r,arguments)}var r={en:{},fr:{}},t=e("$").intl;return n.all=r,n}(),o=e("webgl.resize"),a=e("game1.coords");r.paint=function(e,n,r){var t=e.gl,c=e.playground,i=e.legend,l=e.time,u=e.hero,s=e.resolution;o(t,s),t.clearColor(.4,.6,1,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),i.centerX=(.5*t.canvas.width-10)/n,i.centerY=(.5*t.canvas.height-10)/n,i.zoom=n,i.paint(l),c.zoom=r,a.set(u.col,u.row),c.centerX=a.x,c.centerY=a.y,c.paint(l)},r.clamp=function(e,n,r){return e>r?r:e<n?n:e},n.exports._=t});
//# sourceMappingURL=game1.sequence.js.map
require("game1.coords",function(t,r,e){var n=function(){function r(){return n(e,arguments)}var e={en:{},fr:{}},n=t("$").intl;return r.all=e,r}(),o=0,u=0,i=0;r.exports={x:0,y:0,set:function(t,r){this.x=Math.floor(.5+64*t),this.y=Math.floor(.5+64*r),i=.5-r*o},computeZ:function(t){return void 0===t?i:i-t*o}},Object.defineProperty(r.exports,"rows",{get:function(){return u},set:function(t){u=t,o=u>0?1/u:0},enumerable:!1,configurable:!1}),r.exports._=n});
//# sourceMappingURL=game1.coords.js.map
require("webgl.resize",function(n,t,e){var i=function(){function t(){return i(e,arguments)}var e={en:{},fr:{}},i=n("$").intl;return t.all=e,t}();t.exports=function(n,t){"number"!=typeof t&&(t=window.devicePixelRatio);var e=Math.floor(n.canvas.clientWidth*t),i=Math.floor(n.canvas.clientHeight*t);n.canvas.width===e&&n.canvas.height===i||(n.canvas.width=e,n.canvas.height=i,n.viewport(0,0,e,i))},t.exports._=i});
//# sourceMappingURL=webgl.resize.js.map
require("game1.jumper.monster",function(i,t,r){function o(){var i,t=this.hero.col-this.col,r=this.hero.row-this.row;if(Math.abs(t)===Math.abs(r)&&(i=t>0?r>0?this.SE:this.NE:r>0?this.SW:this.NW,i.canMove()))return i;if(this.dir.canMove())return this.dir;if(Math.random()<.5){var o=this.dir.sideDir[0];this.dir.sideDir[0]=this.dir.sideDir[1],this.dir.sideDir[1]=o}return i=this[this.dir.sideDir[0]],i.canMove()?i:(i=this[this.dir.sideDir[1]],i.canMove()?i:this[this.dir.backDir])}function e(i,t){return Math.abs(i-t)<.2}var s=function(){function t(){return o(r,arguments)}var r={en:{},fr:{}},o=i("$").intl;return t.all=r,t}(),h=i("game1.jumper"),n=i("game1.coords"),c=(i("game1.controls"),function(i,t,r,o,e,s,n){var c=this;h.call(this,{level:r,col:i,row:t,duration:e}),this.hero=s,this.api=o,this.onVictory=n,this.refMonster=o.addCellXY(99999,99999,3,2),this.NE={dir:"NE",canMove:function(){return r.canMoveNE(c.col,c.row)},move:function(){c.scheduleMoveNE(3,2)},sideDir:["NW","SE"],backDir:"SW"},this.NW={dir:"NW",canMove:function(){return r.canMoveNW(c.col,c.row)},move:function(){c.scheduleMoveNW(3,2)},sideDir:["NE","SW"],backDir:"SE"},this.SE={dir:"SE",canMove:function(){return r.canMoveSE(c.col,c.row)},move:function(){c.scheduleMoveSE(3,2)},sideDir:["NE","SW"],backDir:"NW"},this.SW={dir:"SW",canMove:function(){return r.canMoveSW(c.col,c.row)},move:function(){c.scheduleMoveSW(3,2)},sideDir:["NW","SE"],backDir:"NE"},this.dir=this.SE,this._birth=-1});c.prototype=Object.create(h.prototype),c.prototype.constructor=h.Monster,c.prototype.onMove=function(i,t,r){this.api.z=r,this.api.updateXY(this.refMonster,i,t,i+128,t,i+128,t+128,i,t+128)},c.prototype.onRest=function(i){var t=this._birth,r=this.runtime;if(t<0)return void(this._birth=r.time);var s=r.time-t;if(s<2e3){console.info("[game1.jumper.monster] life=",s),n.set(this.col,this.row);var h=n.x+64,c=n.y+64-80,a=Math.PI*s*.002,u=90;s<1e3&&(u*=2*s/2e3);var d=u*Math.cos(a),v=u*Math.sin(a),M=1+.2*Math.cos(.025*s+0),l=1+.2*Math.cos(.027*s+1),f=1+.2*Math.cos(.029*s+2),p=1+.2*Math.cos(.023*s+3);return this.api.z=n.z,void this.api.updateXY(this.refMonster,h+M*d,c+M*v,h+l*v,c-l*d,h-f*d,c-f*v,h-p*v,c+p*d)}e(this.col,this.hero.col)&&e(this.row,this.hero.row)&&this.onVictory(this),this.dir=o.call(this),this.dir.canMove()&&this.dir.move()},c.prototype.onJump=function(){this.api.updateCell(this.refMonster,this.U,this.V)},t.exports=c,t.exports._=s});
//# sourceMappingURL=game1.jumper.monster.js.map
require("game1.jumper",function(t,i,o){function s(t){this.U=t.U||0,this.V=t.V||0,this.col=t.col||0,this.row=t.row||0,this._level=t.level,this.duration=t.duration||300,this._onJump=t.onJump,this._onRest=t.onRest,this._onMove=t.onMove,this._isJumping=-1,this._startJump=0,this._nextAction=null}var h=function(){function i(){return s(o,arguments)}var o={en:{},fr:{}},s=t("$").intl;return i.all=o,i}(),e=t("game1.coords");i.exports=s,s.prototype.fireMove=function(t,i){void 0===t&&(t=this.col),void 0===i&&(i=this.row),e.set(t,i),this.onMove(e.x,e.y-80,e.computeZ(.3))},s.prototype.play=function(t){var i=t.time;if(this.runtime=t,-1===this._isJumping)this._isJumping=0;else if(1===this._isJumping){var o=(i-this._startJump)/this.duration;o<0?o=0:o>1&&(o=1);var s=1-o,h=s*this._col0+o*this._col1;this.col=h;var e=s*this._row0+o*this._row1;this.row=e,e-=.5*Math.sin(Math.PI*o),this.fireMove(h,e),1===o&&(this.col=this._col1,this.row=this._row1,this.onRest(!0),this._isJumping=0)}else this._nextAction?(this._nextAction(i),this._nextAction=null,this.onJump(this)):this.onRest(!1)},s.prototype.onJump=function(){},s.prototype.onRest=function(t){},s.prototype.onMove=function(t,i,o){},s.prototype.scheduleMoveNE=function(t,i){this._level.canMoveNE(this.col,this.row)&&(this._nextAction=this._moveNE,this.U=t,this.V=i)},s.prototype.scheduleMoveNW=function(t,i){this._level.canMoveNW(this.col,this.row)&&(this._nextAction=this._moveNW,this.U=t,this.V=i)},s.prototype.scheduleMoveSE=function(t,i){this._level.canMoveSE(this.col,this.row)&&(this._nextAction=this._moveSE,this.U=t,this.V=i)},s.prototype.scheduleMoveSW=function(t,i){this._level.canMoveSW(this.col,this.row)&&(this._nextAction=this._moveSW,this.U=t,this.V=i)},s.prototype._moveNE=function(t){this._col0=this.col,this._row0=this.row,this._col1=this.col+1,this._row1=this.row-1,this._startJump=t,this._isJumping=1},s.prototype._moveNW=function(t){this._col0=this.col,this._row0=this.row,this._col1=this.col-1,this._row1=this.row-1,this._startJump=t,this._isJumping=1},s.prototype._moveSE=function(t){this._col0=this.col,this._row0=this.row,this._col1=this.col+1,this._row1=this.row+1,this._startJump=t,this._isJumping=1},s.prototype._moveSW=function(t){this._col0=this.col,this._row0=this.row,this._col1=this.col-1,this._row1=this.row+1,this._startJump=t,this._isJumping=1},i.exports._=h});
//# sourceMappingURL=game1.jumper.js.map
require("tfw.message",function(e,n,o){function r(e,n,o){u||(u=l.div("tfw-message","thm-ele24"),document.body.appendChild(u)),"number"!=typeof o&&(o=5e3),l.removeClass(u,"info","error"),l.addClass(u,e),l.clear(u,n),window.setTimeout(function(){l.addClass(u,"show")}),i&&window.clearTimeout(i),i=window.setTimeout(function(){l.removeClass(u,"show")},o)}var i,t=function(){function n(){return r(o,arguments)}var o={en:{}},r=e("$").intl;return n.all=o,n}(),l=e("dom"),u=null;o.info=r.bind(null,"info"),o.error=r.bind(null,"error"),o.clear=function(){i&&window.clearTimeout(i),l.addRemove(u,"show")},n.exports._=t});
//# sourceMappingURL=tfw.message.js.map
require("dom",function(e,t,r){function n(e,t,r){return Object.defineProperty(e,"element",{value:t,writable:!1,configurable:!1,enumerable:!0}),r?e:(e.on=u.bind(e,t),e.css=i.bind(e,t),e.add=l.bind(e,t),e.att=s.bind(e,t),e.addClass=d.bind(e,t),e.hasClass=v.bind(e,t),e.removeClass=m.bind(e,t),e.toggleClass=y.bind(e,t),e)}function o(e,t){return e=L(e),t=L(t),t.parentNode.replaceChild(e,t),e}function i(e,t){e=L(e);var r,n;for(r in t)n=t[r],e.style[r]=n;return e}function s(e,t,r){e=L(e);var n,o;"string"==typeof t&&(n=t,t={},t[n]=r);for(n in t)o=t[n],e.setAttribute(n,o);return e}function a(e,t){return e=L(e),e.removeAttribute(t),e}function l(e){e=L(e);try{var t,r;for(t=1;t<arguments.length;t++){if("string"==typeof(r=arguments[t])||"number"==typeof r)if(r=""+r,"<html>"==r.substr(0,6)){var n=r.substr(6);r=L.tag("span"),r.innerHTML=n}else if(N.test(r)){var o=r;r=L.tag("span"),r.innerHTML=o}else r=document.createTextNode(r);else"function"==typeof r.element?r=r.element():void 0!==r.element&&(r=r.element);e.appendChild(r)}return e}catch(e){throw console.error("[DOM.add] arguments=",[].slice.call(arguments)),Error("[DOM.add] "+e)}}function c(e){if(Array.isArray(e))return e.forEach(function(e){c(e)}),e;if(void 0===e[S])return e;var t=e[S].events;if(void 0===t)return e;t.off(),delete e[S].events}function u(e,t){if("function"!=typeof t&&null!==t||(t={tap:t}),Array.isArray(e))return e.forEach(function(e){u(e,t)}),e;e=L(e),void 0===e[S]&&(e[S]={}),void 0===e[S].events&&(e[S].events=new x(e));var r,n,o;for(r in t)n=t[r],"!"==r.charAt(0)?(r=r.substr(1),o=!0):o=!1,"keydown"==r||"keyup"==r?e.addEventListener(r,n,o):e[S].events.on(r,n,o);return e}function f(e,t){try{var r,n,o,i,s=document.createElementNS(e,t);for(r=2;r<arguments.length;r++)if(n=arguments[r],Array.isArray(n))n.forEach(function(e){switch(typeof e){case"string":case"number":case"boolean":if(e=""+e,"<html>"==e.substr(0,6)){var t=e.substr(6);e=L.tag("span"),e.innerHTML=t}else e=document.createTextNode(e)}l(s,e)});else switch(typeof n){case"string":n.split(" ").forEach(function(e){e.length>0&&d(s,e)});break;case"object":for(o in n)i=n[o],s.setAttribute(o,i);break;default:throw Error("[dom.tag] Error creating <"+t+">: Invalid argument #"+r+"!")}return s}catch(r){console.error("[dom.tagNS] Error with `ns` = ",e," and `name` = ",t),console.error(r)}}function d(e){var t=[].slice.call(arguments,1);return Array.isArray(e)?(t.unshift(null),e.forEach(function(e){t[0]=e,d.apply(void 0,t)}),e):(e=L(e),t.forEach(function(t){if("string"==typeof t&&(t=t.trim(),0!=t.length))try{e.classList&&e.classList.add(t)}catch(e){console.error("[dom.addClass] Invalid class name: ",t),console.error(e)}}),e)}function v(e,t){return e=L(e),!!e.classList&&e.classList.contains(t)}function m(e){var t=[].slice.call(arguments,1);return Array.isArray(e)?(t.unshift(null),e.forEach(function(e){t[0]=e,m.apply(void 0,t)}),e):(e=L(e),t.forEach(function(t){if("string"==typeof t)try{e.classList&&e.classList.remove(t)}catch(e){console.error("[dom.removeClass] Invalid class name: ",t),console.error(e)}}),e)}function y(e){return[].slice.call(arguments,1).forEach(function(t){v(e,t)?m(e,t):d(e,t)}),e}function h(e){e=L(e);for(var t=e;t.firstChild;)t.removeChild(t.firstChild);var r=[].slice.call(arguments);return r.length>1&&l.apply(this,r),e}function p(e,t){return e=L(e),void 0===t&&(t=e,e=window.document),e.querySelector(t)}function g(e){e=L(e);var t=e.parentElement;return t?(t.removeChild(e),t):t}function w(e){var t=[].slice.call(arguments);t.shift(),0==t.length&&(t=["div"]),t.push("dom","custom");var r;return void 0!==t[0].element?(r=t[0].element,d(r,"dom","custom")):"function"==typeof t[0].appendChild?(r=t[0],d(r,"dom","custom")):r=L.tag.apply(L,t),Object.defineProperty(e,"element",{value:r,writable:!1,configurable:!1,enumerable:!0}),r}function b(e,t){return void 0===t&&(t=""),null===t&&(t=""),"string"!=typeof t&&(t=JSON.stringify(t)),"<html>"==t.substr(0,6)?e.innerHTML=t.substr(6):e.textContent=t,e}function A(e){if(!Array.isArray(e))return A(Array.prototype.slice.call(arguments));e.forEach(function(e){e=L(e),void 0===e[S]&&(e[S]={}),Array.isArray(e[S].style)||(e[S].style=[]),e[S].style.push(JSON.stringify(e.style))})}function E(e){if(!Array.isArray(e))return E(Array.prototype.slice.call(arguments));e.forEach(function(e){if(e=L(e),void 0===e[S]||!Array.isArray(e[S].style))throw Error("[dom.restoreStyle] `saveStyle()` has never been used on this element!");if(0==e[S].style.length)throw Error("[dom.restoreStyle] more `restore` than `save`!");var t,r,n=JSON.parse(e[S].style.pop());for(t in n)void 0!==(r=n[t])&&(e.style[t]=r)})}var C=function(){function t(){return n(r,arguments)}var r={en:{}},n=e("$").intl;return t.all=r,t}();e("polyfill.classList");var x=e("tfw.pointer-events"),L=function(e){if("string"==typeof e){var t=document.getElementById(e);return t||console.error("[dom] There is no DOM element with this ID: `"+e+"`"),t}if(!e)throw Error("`dom` is not a valid element!",e);return"function"==typeof e.element?e.element():e.element?e.element:e};t.exports=L;var S="@dom"+Date.now(),N=/^&(#[0-9]+|[a-zA-Z0-9]+);$/;L.tagNS=f,L.svgRoot=f.bind(void 0,"http://www.w3.org/2000/svg","svg",{version:"1.1","xmlns:svg":"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),L.svg=f.bind(void 0,"http://www.w3.org/2000/svg"),L.tag=f.bind(void 0,"http://www.w3.org/1999/xhtml"),L.div=f.bind(void 0,"http://www.w3.org/1999/xhtml","div"),L.txt=window.document.createTextNode.bind(window.document),L.textOrHtml=b,L.get=p,L.elem=w,L.css=i,L.att=s,L.removeAtt=a,L.addClass=d,L.hasClass=v,L.removeClass=m,L.toggleClass=y,L.saveStyle=A,L.restoreStyle=E,L.replace=o,L.detach=g,L.on=u,L.off=c,L.add=l,L.wrap=n,L.clear=h,t.exports._=C});
//# sourceMappingURL=dom.js.map
require("tfw.pointer-events",function(t,e,o){function n(t){var e=this;this._slots={},this._eventListeners=[],Object.defineProperty(n.prototype,"element",{value:t,writable:!1,configurable:!0,enumerable:!0}),a.call(e,t,"touchstart",function(o){o.preventDefault(),i.touchDevice||(i.touchDevice=!0,document.body.removeEventListener("mousedown",p,!0),document.body.removeEventListener("mousemove",l,!0),document.body.removeEventListener("mouseup",u,!0));var n=e._slots;1==o.touches.length&&(i.rect=t.getBoundingClientRect(),i.bodyMoveX=o.touches[0].clientX,i.bodyMoveY=o.touches[0].clientY,i.bodyDownX=o.touches[0].clientX,i.bodyDownY=o.touches[0].clientY,i.targetX=o.touches[0].clientX-i.rect.left,i.targetY=o.touches[0].clientY-i.rect.top,i.time=Date.now(),n.down&&n.down({action:"down",button:i.bodyButton,target:t,x:i.targetX,y:i.targetY,stopPropagation:o.stopPropagation.bind(o),preventDefault:o.preventDefault.bind(o)}))}),a.call(e,t,"touchmove",function(o){o.preventDefault();var n=i.bodyMoveX,a=i.bodyMoveY;i.bodyMoveX=o.touches[0].clientX,i.bodyMoveY=o.touches[0].clientY;var r=e._slots;r.drag&&r.drag({action:"drag",target:t,x0:i.targetX,y0:i.targetY,x:i.bodyMoveX-i.rect.left,y:i.bodyMoveY-i.rect.top,dx:i.bodyMoveX-i.bodyDownX,dy:i.bodyMoveY-i.bodyDownY,vx:i.bodyMoveX-n,vy:i.bodyMoveY-a,stopPropagation:o.stopPropagation.bind(o),preventDefault:o.preventDefault.bind(o)})}),a.call(e,t,"touchend",function(t){t.preventDefault();var o=e._slots,n=i.bodyMoveX-i.bodyDownX,a=i.bodyMoveY-i.bodyDownY;if(o.up&&o.up({action:"up",target:e.element,x:i.bodyMoveX-i.rect.left,y:i.bodyMoveY-i.rect.top,dx:n,dy:a,stopPropagation:t.stopPropagation.bind(t),preventDefault:t.preventDefault.bind(t)}),n*n+a*a<256){var r=Date.now();i.lastTapTime>0&&(o.doubletap&&r-i.lastTapTime<400?o.doubletap({action:"doubletap",target:i.bodyTarget,x:i.bodyMoveX-i.rect.left,y:i.bodyMoveY-i.rect.top,stopPropagation:t.stopPropagation.bind(t),preventDefault:t.preventDefault.bind(t)}):i.lastTapTime=0),o.tap&&0==i.lastTapTime&&(t.stopPropagation(),t.preventDefault(),o.tap({action:"tap",target:i.bodyTarget,x:i.bodyMoveX-i.rect.left,y:i.bodyMoveY-i.rect.top,stopPropagation:t.stopPropagation.bind(t),preventDefault:t.preventDefault.bind(t)})),i.lastTapTime=r}}),a.call(e,t,"mousedown",function(o){if(!i.touchDevice){var n=e._slots,a=t.getBoundingClientRect();i.target=e,i.targetX=o.clientX-a.left,i.targetY=o.clientY-a.top,n.down&&n.down({action:"down",button:i.bodyButton,target:i.bodyTarget,x:i.targetX,y:i.targetY,stopPropagation:o.stopPropagation.bind(o),preventDefault:o.preventDefault.bind(o)})}}),a.call(e,t,"mousemove",function(o){var n=e._slots;if(n.move){var a=t.getBoundingClientRect();o.target.getBoundingClientRect();n.move({target:t,action:"move",x:o.clientX-a.left,y:o.clientY-a.top})}}),Object.defineProperty(this,"element",{value:t,writable:!0,configurable:!0,enumerable:!0})}function a(t,e,o,n){t.addEventListener(e,o,n),this._eventListeners.push([t,e,o,n])}var r=function(){function e(){return n(o,arguments)}var o={en:{}},n=t("$").intl;return e.all=o,e}(),d="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",i={touchDevice:!1,target:null,targetX:0,targetY:0,bodyDownX:0,bodyDownY:0,bodyMoveX:-1,bodyMoveY:-1,bodyMoveLastX:-1,bodyMoveLastY:-1,onDrag:null,lastTapTime:0},p=function(t){i.touchDevice||(i.bodyDownX=t.pageX,i.bodyDownY=t.pageY,i.bodyMoveX=t.pageX,i.bodyMoveY=t.pageY,i.bodyMoveLastX=t.pageX,i.bodyMoveLastY=t.pageY,i.bodyTarget=t.target,i.bodyButton=t.button)},l=function(t){if(!i.touchDevice&&i.target&&(t.stopPropagation(),t.preventDefault(),i.bodyMoveLastX=i.bodyMoveX,i.bodyMoveLastY=i.bodyMoveY,i.bodyMoveX=t.pageX,i.bodyMoveY=t.pageY,i.target)){var e=i.target._slots;"function"==typeof e.drag&&e.drag({action:"drag",target:i.target.element,x0:i.targetX,y0:i.targetY,x:i.targetX+i.bodyMoveX-i.bodyDownX,y:i.targetY+i.bodyMoveY-i.bodyDownY,dx:i.bodyMoveX-i.bodyDownX,dy:i.bodyMoveY-i.bodyDownY,vx:i.bodyMoveX-i.bodyMoveLastX,vy:i.bodyMoveY-i.bodyMoveLastY,button:i.bodyButton})}},u=function(t){if(!i.touchDevice&&i.target){t.stopPropagation(),t.preventDefault();var e=Date.now(),o=i.target._slots,n=t.pageX-i.bodyDownX,a=t.pageY-i.bodyDownY;o.up&&o.up({action:"up",target:i.bodyTarget,x:i.targetX+n,y:i.targetY+a,dx:n,dy:a,button:i.bodyButton,stopPropagation:t.stopPropagation.bind(t),preventDefault:t.preventDefault.bind(t)}),n*n+a*a<1024&&(i.lastTapTime>0&&(o.doubletap&&e-i.lastTapTime<400?o.doubletap({action:"doubletap",target:i.bodyTarget,x:i.targetX+n,y:i.targetY+a}):i.lastTapTime=0),o.tap&&0==i.lastTapTime&&o.tap({action:"tap",target:i.bodyTarget,x:i.targetX+n,y:i.targetY+a}),i.lastTapTime=e),delete i.target}};document.body.addEventListener("mousedown",p,!0),document.body.addEventListener("mousemove",l,!0),document.body.addEventListener("mouseup",u,!0),n.prototype.on=function(t,e){var o=this,n=this._slots;return"function"==typeof e&&(n[t]=e),"wheel"==t&&a.call(o,this.element,d,function(t){var e=o.element.getBoundingClientRect();n.wheel({target:i.bodyTarget,action:"wheel",delta:t.deltaY,x:t.clientX-e.left,y:t.clientY-e.top,stopPropagation:t.stopPropagation.bind(t),preventDefault:t.preventDefault.bind(t)})}),this},n.prototype.off=function(){this._eventListeners.forEach(function(t){var e=t[0],o=t[1],n=t[2],a=t[3];e.removeEventListener(o,n,a)})},e.exports=n,e.exports._=r});
//# sourceMappingURL=tfw.pointer-events.js.map
require("polyfill.classList",function(t,e,n){var i=function(){function e(){return i(n,arguments)}var n={en:{}},i=t("$").intl;return e.all=n,e}();"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,i=arguments.length;for(n=0;n<i;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}t=null}():function(t){"use strict";if("Element"in t){var e=t.Element.prototype,n=Object,i=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array.prototype.indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},r=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},o=function(t,e){if(""===e)throw new r("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new r("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(t,e)},c=function(t){for(var e=i.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],s=0,r=n.length;s<r;s++)this.push(n[s]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},a=c.prototype=[],l=function(){return new c(this)};if(r.prototype=Error.prototype,a.item=function(t){return this[t]||null},a.contains=function(t){return t+="",-1!==o(this,t)},a.add=function(){var t,e=arguments,n=0,i=e.length,s=!1;do{t=e[n]+"",-1===o(this,t)&&(this.push(t),s=!0)}while(++n<i);s&&this._updateClassName()},a.remove=function(){var t,e,n=arguments,i=0,s=n.length,r=!1;do{for(t=n[i]+"",e=o(this,t);-1!==e;)this.splice(e,1),r=!0,e=o(this,t)}while(++i<s);r&&this._updateClassName()},a.toggle=function(t,e){t+="";var n=this.contains(t),i=n?!0!==e&&"remove":!1!==e&&"add";return i&&this[i](t),!0===e||!1===e?e:!n},a.toString=function(){return this.join(" ")},n.defineProperty){var u={get:l,enumerable:!0,configurable:!0};try{n.defineProperty(e,"classList",u)}catch(t){-2146823252===t.number&&(u.enumerable=!1,n.defineProperty(e,"classList",u))}}else n.prototype.__defineGetter__&&e.__defineGetter__("classList",l)}}(self)),e.exports._=i});
//# sourceMappingURL=polyfill.classList.js.map
require("game1.sequence.buildlevel",function(e,l,n){function r(e){var l,n=e.gl,r=(e.playground,e.legend,e.time),o=(e.hero,e.monsters,e.level,e.resolution,Math.min(n.canvas.width,n.canvas.height)/700),t=o;r<1e3&&(l=i.clamp(.001*r,0,1),t*=.95*Math.sin(Math.PI*l)+l),r<500?o=0:r<1500?(l=i.clamp(.001*(r-500),0,1),o*=.75*Math.sin(Math.PI*l)+l):e.setNextSequence("PlayTime"),i.paint(e,o,t)}function o(e,l){e.clear();var n=[];return e.z=-1,l.transformations.forEach(function(l,r){n.push([e.addScaledCellXY(0,32*r,r,1,.5),r]),n.push([e.addScaledCellXY(70,32*r+10,3,1,.3),3]),n.push([e.addScaledCellXY(112,32*r,l,1,.5),l])}),e.highlight=function(l){n.forEach(function(n,r){var o=n[0],t=n[1],a=Math.floor(r/3)===l?0:1;e.updateCell(o,t,a)})},e}function t(e,l){e.clear();var n,r,o,t,a,c={},s=1/l.rows;for(r=0;r<l.rows;r+=2){for(n=0;n<l.cols;n+=2)a=l.getFence(n,r),a>-1&&(o="F"+n+","+r,u.set(n,r),e.z=.5-(r+.9)*s,c[o]=e.addCellXY(u.x,u.y,a,2)),(t=l.getValue(n,r))>-1&&(o=n+","+r,u.set(n,r),e.z=.5-r*s,c[o]=e.addCellXY(u.x,u.y,t,0));for(n=1;n<l.cols;n+=2)a=l.getFence(n,r+1),a>-1&&(o="F"+n+","+(r+1),u.set(n,r+1),e.z=.5-(r+1.9)*s,c[o]=e.addCellXY(u.x,u.y,a,2)),(t=l.getValue(n,r+1))>-1&&(o=n+","+(r+1),u.set(n,r+1),e.z=.5-(r+1)*s,c[o]=e.addCellXY(u.x,u.y,t,0))}return u.set(l.hero.col,l.hero.row),e.centerX=u.x,e.centerY=u.y,c}var a=function(){function l(){return r(n,arguments)}var n={en:{},fr:{}},r=e("$").intl;return l.all=n,l}(),c=e("game1.jumper.hero"),s=e("game1.levels"),u=e("game1.coords"),i=(e("game1.jumper.monster"),e("game1.sequence"));r.init=function(e){console.log("Loading level",e.levelIndex),console.info("[sequence.buildlevel] runtime.time=",e.time),e.level=s(e.levelIndex),u.rows=e.level.rows;var l=t(e.playground,e.level);o.call(this,e.legend,e.level),e.hero=new c(e.level.hero.col,e.level.hero.row,e.level,e.playground,function(n,r){var o=n+","+r,t=l[o];e.legend.highlight(e.level.getValue(n,r)),e.playground.updateCell(t,e.level.transform(n,r),0)}),e.monsters=[]},l.exports=r,l.exports._=a});
//# sourceMappingURL=game1.sequence.buildlevel.js.map
<<<<<<< HEAD
require("game1.levels",function(e,t,o){function r(e){"number"!=typeof e&&(e=0);var t=n(a[e%a.length]);this._level=t;this._level.map;l(this,"hero",t.hero),l(this,"transformations",t.tr),l(this,"cols",t.map[0].length),l(this,"rows",t.map.length),l(this,"monsters",t.monsters||[])}function n(e){e=i(e);var t,o=e.map[0];for(t=0;t<o.length&&" "==o.charAt(t);t++);if(Array.isArray(e.monsters)||(e.monsters=[]),t%2==1&&(e.map=e.map.map(function(e){return" "+e}),e.hero.col++,e.monsters.forEach(function(e){e.col++})),e.map.length%2==1){for(o="",t=0;t<e.map[0].length;t++)o+=" ";e.map.push(o)}return e.map=e.map.map(function(e){for(var t=[],o=0;o<e.length;o++)t.push(e.charAt(o));return t}),e.todo=0,e.map.forEach(function(t){t.forEach(function(t){"12".indexOf(t)>-1&&e.todo++})}),console.info("[game1.levels] level=",e),e}function i(e){return JSON.parse(JSON.stringify(e))}function l(e,t,o){return Object.defineProperty(e,t,{value:o,writable:!1,configurable:!1,enumerable:!0})}var s=function(){function t(){return r(o,arguments)}var o={en:{},fr:{}},r=e("$").intl;return t.all=o,t}(),a=[{map:["   1   ","  1 1  "," 1 1 1 ","1 1 1 1"],tr:[0,0,0],hero:{col:3,row:2},monsters:[{col:3,row:0,birth:3e4,duration:300}]},{map:["      2      ","     2 2     ","    2 1 2    ","   2 1 1 2   ","  2 1   1 2  "," 2 1 1 1 1 2 ","2 2 2 2 2 2 2"],tr:[0,0,1],hero:{col:6,row:0},monsters:[{col:6,row:0,birth:3e4,duration:700},{col:0,row:6,birth:4e4,duration:710},{col:12,row:6,birth:5e4,duration:720}]},{map:["      2     2      ","     2 2   2 2     ","    2   2 2   2    ","   2     2     2   ","  2     2 2     2  "," 2     2   2     2 ","2     2     2     2"," 2   2       2   2 ","  2 2         2 2  ","   2           2   "],tr:[0,0,1],hero:{col:12,row:0},monsters:[{col:6,row:0,birth:1e3,duration:700}]},{map:["    2 1 2    ","  2 2  ","   1   "],tr:[2,0,1],hero:{col:3,row:3},monsters:[{col:3,row:3,birth:9e4,duration:1e3}]},{map:["    1       2               1    ","   2 2     2 2             2 2   ","  2 1 2   2   2           2 1 2  "," 2 1 1 2 2     2 1       2[1 1 2 ","1 1 1 1 1     1 2 1     1 1 1 1 1"," 2 1 1 2       1 2     2 2 1 1 2 ","  2 1 2           2   2   2 1 2  ","   2 2             2 2     2 2   ","    1               2       1    "],tr:[0,0,1],hero:{col:0,row:4},monsters:[{col:32,row:4,birth:5e3,duration:500}]},{map:["    2 1 2    ","     1 1     ","    1 2 1    ","   1 2 2 1   ","  1 2 0 2 1  "," 1 2     2 1 ","1 1       1 1"," 1 2[    2]1 ","  1 2[0 2]1  ","   1 2[2]1   ","    1 2v1    ","     1 1     ","    2 1 2    "],tr:[2,0,1],hero:{row:4,col:6},monsters:[{row:0,col:6,birth:15e3,duration:1200},{row:12,col:6,birth:3e4,duration:1e3},{row:12,col:6,birth:18e4,duration:500}]}];r.prototype.moveNE=function(){var e=this._level.hero;e.col++,e.row--},r.prototype.moveNW=function(){var e=this._level.hero;e.col--,e.row--},r.prototype.moveSE=function(){var e=this._level.hero;e.col++,e.row++},r.prototype.moveSW=function(){var e=this._level.hero;e.col--,e.row++},r.prototype.canMoveNE=function(e,t){var o=(this._level.hero,this.getFence(e+1,t-1));return 0!==o&&2!==o&&!(this.getValue(e+1,t-1)<0)},r.prototype.canMoveNW=function(e,t){var o=(this._level.hero,this.getFence(e-1,t-1));return 1!==o&&2!==o&&!(this.getValue(e-1,t-1)<0)},r.prototype.canMoveSE=function(e,t){var o=(this._level.hero,this.getFence(e,t));return 1!==o&&2!==o&&!(this.getValue(e+1,t+1)<0)},r.prototype.canMoveSW=function(e,t){var o=(this._level.hero,this.getFence(e,t));return 0!==o&&2!==o&&!(this.getValue(e-1,t+1)<0)},r.prototype.getValue=function(e,t){return t<0||t>=this.rows||e<0||e>=this.cols?-1:"012".indexOf(this._level.map[t][e])},r.prototype.getFence=function(e,t){return t<0||t>=this.rows||e<0||e>=this.cols?-1:"[]v".indexOf(this._level.map[t][e+1])},r.prototype.transform=function(e,t){var o=this.getValue(e,t);if(o<0)return-1;var r=this._level.tr[o];return this._level.map[t][e]=""+r,0!=o&&0==r?this._level.todo--:0==o&&0!=r&&this._level.todo++,r},r.prototype.isDone=function(){return this._level.todo<=0},t.exports=function(e){return a[e]?new r(e):(console.error("Level `"+e+"` doe not exist!"),null)},t.exports._=s});
//# sourceMappingURL=game1.levels.js.map
require("game1.jumper.hero",function(t,e,o){var r=function(){function e(){return r(o,arguments)}var o={en:{},fr:{}},r=t("$").intl;return e.all=o,e}(),i=t("game1.jumper"),s=t("game1.controls"),n=function(t,e,o,r,s){i.call(this,{level:o,col:t,row:e}),this.api=r,this.onTransform=s,this.refHero=r.addCellXY(99999,99999,0,3)};n.prototype=Object.create(i.prototype),n.prototype.constructor=i.Hero,n.prototype.onMove=function(t,e,o){this.api.z=o,this.api.updateXY(this.refHero,t,e,t+128,e,t+128,e+128,t,e+128)},n.prototype.onRest=function(t){t&&this.onTransform(this.col,this.row),s.NE?this.scheduleMoveNE(2,3):s.NW?this.scheduleMoveNW(0,3):s.SW?this.scheduleMoveSW(3,3):s.SE&&this.scheduleMoveSE(1,3)},n.prototype.onJump=function(){this.api.updateCell(this.refHero,this.U,this.V)},e.exports=n,e.exports._=r});
//# sourceMappingURL=game1.jumper.hero.js.map
require("webgl.fast-sprite",function(t,e,r){function i(t){this._opts=t,void 0===t&&a("Constructor's argument is mandatory!"),void 0===t.gl&&a("Constructor's argument `gl` is mandatory!");var e=t.gl;this._gl=e,void 0===t.atlas&&a("Constructor's argument `atlas` is mandatory!"),this.updateAtlas(t.atlas),this._nbAttributes=5,this._capacity=_,this._vertData=new Float32Array(4*_*this._nbAttributes),this._vertBuff=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertBuff),e.bufferData(e.ARRAY_BUFFER,this._vertData,e.DYNAMIC_DRAW),this._elemData=new Uint16Array(6*_),this._elemBuff=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._elemBuff),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._elemData,e.DYNAMIC_DRAW),this._references=new Uint16Array(_),this._quadsCount=0,this._ptrVert=0,this._ptrElem=0,this._idxVert=0,this.zoom=1,this.x=this.y=this.z=0,this.centerX=this.centerY=this.centerZ=0,this._prg=new o(e,{vert:n.vert,frag:n.frag})}function a(t){throw Error("[ToloFastSprite] "+t+"\nMore detail at https://github.com/tolokoban/tolo-fast-sprite")}var s=function(){function e(){return i(r,arguments)}var r={en:{},fr:{}},i=t("$").intl;return e.all=r,e}(),n={vert:"uniform float uniWidth;\r\nuniform float uniHeight;\r\nuniform float uniX;\r\nuniform float uniY;\r\nuniform float uniZ;\r\nuniform float uniZoom;\r\n\r\nattribute vec3 attPosition;\r\nattribute vec2 attUV;\r\nvarying vec2 varUV;\r\n\r\nvoid main() {\r\n  varUV = attUV;\r\n  \r\n  vec3 pos = attPosition - vec3( uniX, uniY, uniZ );\r\n  gl_Position = vec4( pos, 1.0 );\r\n\r\n  // Convert pixels to WebGL space coords.\r\n  gl_Position.x = (2.0 * gl_Position.x / uniWidth) * uniZoom;\r\n  gl_Position.y = (-2.0 * gl_Position.y / uniHeight) * uniZoom;\r\n}\r\n",frag:"precision lowp float;\r\n\r\nvarying vec2 varUV;\r\n\r\n// Textures.\r\nuniform sampler2D tex;\r\n\r\nvoid main() { \r\n  gl_FragColor = texture2D(tex, varUV);\r\n  if( gl_FragColor.a <= 1.0 / 255.0 ) discard;\r\n}\r\n"},o=t("webgl.program"),_=256;e.exports=i,i.prototype.updateCell=function(t,e,r){var i=this._opts,a=i.cellSrcW,s=i.cellSrcH,n=(i.cellDstW,i.cellDstH,this._nbAttributes),o=(this.z,this._vertData);o[t+3]=a*e,o[t+4]=s*r,t+=n,o[t+3]=a*(1+e),o[t+4]=s*r,t+=n,o[t+3]=a*(1+e),o[t+4]=s*(1+r),t+=n,o[t+3]=a*e,o[t+4]=s*(1+r)},i.prototype.updateXY=function(t,e,r,i,a,s,n,o,_){var h=this._nbAttributes,u=this.z||0,l=this._vertData;l[t+0]=e,l[t+1]=r,l[t+2]=u,t+=h,l[t+0]=i,l[t+1]=a,l[t+2]=u,t+=h,l[t+0]=s,l[t+1]=n,l[t+2]=u,t+=h,l[t+0]=o,l[t+1]=_,l[t+2]=u},i.prototype.updateZ=function(t,e){var r=this._nbAttributes,i=this._vertData;i[t+2]=e,t+=r,i[t+2]=e,t+=r,i[t+2]=e,t+=r,i[t+2]=e},i.prototype.clear=function(){this._quadsCount=0,this._ptrVert=0,this._ptrElem=0,this._idxVert=0},i.prototype.paint=function(t){var e=this._gl,r=this._prg,i=this._vertData,a=this._vertBuff,s=this._elemBuff,n=this._elemData;r.use(),r.$uniWidth=e.canvas.width,r.$uniHeight=e.canvas.height,r.$uniX=this.centerX,r.$uniY=this.centerY,r.$uniZ=this.centerZ,r.$uniZoom=this.zoom,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),r.$tex=0,r.bindAttribs(a,"attPosition","attUV"),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferSubData(e.ARRAY_BUFFER,0,i),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,n),e.drawElements(e.TRIANGLES,this._ptrElem,e.UNSIGNED_SHORT,0)},i.prototype.add=function(t,e,r,i,a,s,n,o,_,h,u,l,c,f,v,E,D,p,d,R){this._quadsCount>=this._capacity&&console.warn("Dépassement de capacité !!");var m=this._nbAttributes,T=this._ptrVert,A=this._ptrElem,b=this._idxVert,g=T;return this._vertData[T+0]=t,this._vertData[T+1]=e,this._vertData[T+2]=r,this._vertData[T+3]=i,this._vertData[T+4]=a,T+=m,this._vertData[T+0]=s,this._vertData[T+1]=n,this._vertData[T+2]=o,this._vertData[T+3]=_,this._vertData[T+4]=h,T+=m,this._vertData[T+0]=u,this._vertData[T+1]=l,this._vertData[T+2]=c,this._vertData[T+3]=f,this._vertData[T+4]=v,T+=m,this._vertData[T+0]=E,this._vertData[T+1]=D,this._vertData[T+2]=p,this._vertData[T+3]=d,this._vertData[T+4]=R,T+=m,this._ptrVert=T,this._elemData[A+0]=b+0,this._elemData[A+1]=b+1,this._elemData[A+2]=b+2,this._elemData[A+3]=b+0,this._elemData[A+4]=b+2,this._elemData[A+5]=b+3,this._idxVert+=4,this._ptrElem+=6,this._quadsCount++,g},i.prototype.addCellXY=function(t,e,r,i){var a=this.z||0,s=this._opts,n=s.cellSrcW,o=s.cellSrcH,_=s.cellDstW,h=s.cellDstH;return this.add(t,e,a,n*r,o*i,t+_,e,a,n*(1+r),o*i,t+_,e+h,a,n*(1+r),o*(1+i),t,e+h,a,n*r,o*(1+i))},i.prototype.addScaledCellXY=function(t,e,r,i,a){var s=this.z||0,n=this._opts,o=n.cellSrcW,_=n.cellSrcH,h=n.cellDstW*a,u=n.cellDstH*a;return this.add(t,e,s,o*r,_*i,t+h,e,s,o*(1+r),_*i,t+h,e+u,s,o*(1+r),_*(1+i),t,e+u,s,o*r,_*(1+i))},i.prototype.updateAtlas=function(t){var e=this._gl;if(!this._texture){var r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),this._texture=r}e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)},e.exports._=s});
=======
require("game1.levels",function(e,t,o){function r(e){"number"!=typeof e&&(e=0);var t=n(a[e%a.length]);this._level=t;this._level.map;l(this,"hero",t.hero),l(this,"transformations",t.tr),l(this,"cols",t.map[0].length),l(this,"rows",t.map.length),l(this,"monsters",t.monsters||[])}function n(e){e=i(e);var t,o=e.map[0];for(t=0;t<o.length&&" "==o.charAt(t);t++);if(Array.isArray(e.monsters)||(e.monsters=[]),t%2==1&&(e.map=e.map.map(function(e){return" "+e}),e.hero.col++,e.monsters.forEach(function(e){e.col++})),e.map.length%2==1){for(o="",t=0;t<e.map[0].length;t++)o+=" ";e.map.push(o)}return e.map=e.map.map(function(e){for(var t=[],o=0;o<e.length;o++)t.push(e.charAt(o));return t}),e.todo=0,e.map.forEach(function(t){t.forEach(function(t){"12".indexOf(t)>-1&&e.todo++})}),console.info("[game1.levels] level=",e),e}function i(e){return JSON.parse(JSON.stringify(e))}function l(e,t,o){return Object.defineProperty(e,t,{value:o,writable:!1,configurable:!1,enumerable:!0})}var s=function(){function t(){return r(o,arguments)}var o={en:{},fr:{}},r=e("$").intl;return t.all=o,t}(),a=[{map:["   1   ","  1 1  "," 1 1 1 ","1 1 1 1"],tr:[0,0,0],hero:{col:3,row:2},monsters:[{col:3,row:0,birth:3e4,duration:300}]},{map:["      2      ","     2 2     ","    2 1 2    ","   2 1 1 2   ","  2 1   1 2  "," 2 1 1 1 1 2 ","2 2 2 2 2 2 2"],tr:[0,0,1],hero:{col:6,row:0},monsters:[{col:6,row:0,birth:3e4,duration:700},{col:0,row:6,birth:4e4,duration:710},{col:12,row:6,birth:5e4,duration:720}]},{map:["1 2 2 1"," 2 1 2 ","  2 2  ","   1   "],tr:[2,0,1],hero:{col:3,row:3},monsters:[{col:3,row:3,birth:9e4,duration:1e3}]},{map:["    1       2               1    ","   2 2     2 2             2 2   ","  2 1 2   2   2           2 1 2  "," 2 1 1 2 2     2 1       2[1 1 2 ","1 1 1 1 1     1 2 1     1 1 1 1 1"," 2 1 1 2       1 2     2 2 1 1 2 ","  2 1 2           2   2   2 1 2  ","   2 2             2 2     2 2   ","    1               2       1    "],tr:[0,0,1],hero:{col:0,row:4},monsters:[{col:32,row:4,birth:5e3,duration:500}]},{map:["    2 1 2    ","     1 1     ","    1 2 1    ","   1 2 2 1   ","  1 2 0 2 1  "," 1 2     2 1 ","1 1       1 1"," 1 2[    2]1 ","  1 2[0 2]1  ","   1 2[2]1   ","    1 2v1    ","     1 1     ","    2 1 2    "],tr:[2,0,1],hero:{row:4,col:6},monsters:[{row:0,col:6,birth:15e5,duration:1e3},{row:12,col:6,birth:3e6,duration:800},{row:12,col:6,birth:18e6,duration:500}]}];r.prototype.moveNE=function(){var e=this._level.hero;e.col++,e.row--},r.prototype.moveNW=function(){var e=this._level.hero;e.col--,e.row--},r.prototype.moveSE=function(){var e=this._level.hero;e.col++,e.row++},r.prototype.moveSW=function(){var e=this._level.hero;e.col--,e.row++},r.prototype.canMoveNE=function(e,t){var o=(this._level.hero,this.getFence(e+1,t-1));return 0!==o&&2!==o&&!(this.getValue(e+1,t-1)<0)},r.prototype.canMoveNW=function(e,t){var o=(this._level.hero,this.getFence(e-1,t-1));return 1!==o&&2!==o&&!(this.getValue(e-1,t-1)<0)},r.prototype.canMoveSE=function(e,t){var o=(this._level.hero,this.getFence(e,t));return 1!==o&&2!==o&&!(this.getValue(e+1,t+1)<0)},r.prototype.canMoveSW=function(e,t){var o=(this._level.hero,this.getFence(e,t));return 0!==o&&2!==o&&!(this.getValue(e-1,t+1)<0)},r.prototype.getValue=function(e,t){return t<0||t>=this.rows||e<0||e>=this.cols?-1:"012".indexOf(this._level.map[t][e])},r.prototype.getFence=function(e,t){return t<0||t>=this.rows||e<0||e>=this.cols?-1:"[]v".indexOf(this._level.map[t][e+1])},r.prototype.transform=function(e,t){var o=this.getValue(e,t);if(o<0)return-1;var r=this._level.tr[o];return this._level.map[t][e]=""+r,0!=o&&0==r?this._level.todo--:0==o&&0!=r&&this._level.todo++,r},r.prototype.isDone=function(){return this._level.todo<=0},t.exports=function(e){return a[e]?new r(e):(console.error("Level `"+e+"` doe not exist!"),null)},t.exports._=s});
//# sourceMappingURL=game1.levels.js.map
require("game1.jumper.hero",function(t,e,o){var r=function(){function e(){return r(o,arguments)}var o={en:{},fr:{}},r=t("$").intl;return e.all=o,e}(),i=t("game1.jumper"),s=t("game1.controls"),n=function(t,e,o,r,s){i.call(this,{level:o,col:t,row:e}),this.api=r,this.onTransform=s,this.refHero=r.addCellXY(99999,99999,0,3)};n.prototype=Object.create(i.prototype),n.prototype.constructor=i.Hero,n.prototype.onMove=function(t,e,o){this.api.z=o,this.api.updateXY(this.refHero,t,e,t+128,e,t+128,e+128,t,e+128)},n.prototype.onRest=function(t){t&&this.onTransform(this.col,this.row),s.NE?this.scheduleMoveNE(2,3):s.NW?this.scheduleMoveNW(0,3):s.SW?this.scheduleMoveSW(3,3):s.SE&&this.scheduleMoveSE(1,3)},n.prototype.onJump=function(){this.api.updateCell(this.refHero,this.U,this.V)},e.exports=n,e.exports._=r});
//# sourceMappingURL=game1.jumper.hero.js.map
require("webgl.fast-sprite",function(t,e,i){function r(t){this._opts=t,void 0===t&&a("Constructor's argument is mandatory!"),void 0===t.gl&&a("Constructor's argument `gl` is mandatory!");var e=t.gl;this._gl=e,void 0===t.atlas&&a("Constructor's argument `atlas` is mandatory!"),this.updateAtlas(t.atlas),this._nbAttributes=5,this._capacity=_,this._vertData=new Float32Array(4*_*this._nbAttributes),this._vertBuff=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertBuff),e.bufferData(e.ARRAY_BUFFER,this._vertData,e.DYNAMIC_DRAW),this._elemData=new Uint16Array(6*_),this._elemBuff=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._elemBuff),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._elemData,e.DYNAMIC_DRAW),this._references=new Uint16Array(_),this._quadsCount=0,this._ptrVert=0,this._ptrElem=0,this._idxVert=0,this.zoom=1,this.x=this.y=this.z=0,this.centerX=this.centerY=this.centerZ=0,this._prg=new o(e,{vert:n.vert,frag:n.frag})}function a(t){throw Error("[ToloFastSprite] "+t+"\nMore detail at https://github.com/tolokoban/tolo-fast-sprite")}var s=function(){function e(){return r(i,arguments)}var i={en:{},fr:{}},r=t("$").intl;return e.all=i,e}(),n={vert:"uniform float uniWidth;\nuniform float uniHeight;\nuniform float uniX;\nuniform float uniY;\nuniform float uniZ;\nuniform float uniZoom;\n\nattribute vec3 attPosition;\nattribute vec2 attUV;\nvarying vec2 varUV;\n\nvoid main() {\n  varUV = attUV;\n  \n  vec3 pos = attPosition - vec3( uniX, uniY, uniZ );\n  gl_Position = vec4( pos, 1.0 );\n\n  // Convert pixels to WebGL space coords.\n  gl_Position.x = (2.0 * gl_Position.x / uniWidth) * uniZoom;\n  gl_Position.y = (-2.0 * gl_Position.y / uniHeight) * uniZoom;\n}\n",frag:"precision lowp float;\n\nvarying vec2 varUV;\n\n// Textures.\nuniform sampler2D tex;\n\nvoid main() { \n  gl_FragColor = texture2D(tex, varUV);\n  if( gl_FragColor.a <= 1.0 / 255.0 ) discard;\n}\n"},o=t("webgl.program"),_=256;e.exports=r,r.prototype.updateCell=function(t,e,i){var r=this._opts,a=r.cellSrcW,s=r.cellSrcH,n=(r.cellDstW,r.cellDstH,this._nbAttributes),o=(this.z,this._vertData);o[t+3]=a*e,o[t+4]=s*i,t+=n,o[t+3]=a*(1+e),o[t+4]=s*i,t+=n,o[t+3]=a*(1+e),o[t+4]=s*(1+i),t+=n,o[t+3]=a*e,o[t+4]=s*(1+i)},r.prototype.updateXY=function(t,e,i,r,a,s,n,o,_){var h=this._nbAttributes,u=this.z||0,l=this._vertData;l[t+0]=e,l[t+1]=i,l[t+2]=u,t+=h,l[t+0]=r,l[t+1]=a,l[t+2]=u,t+=h,l[t+0]=s,l[t+1]=n,l[t+2]=u,t+=h,l[t+0]=o,l[t+1]=_,l[t+2]=u},r.prototype.updateZ=function(t,e){var i=this._nbAttributes,r=this._vertData;r[t+2]=e,t+=i,r[t+2]=e,t+=i,r[t+2]=e,t+=i,r[t+2]=e},r.prototype.clear=function(){this._quadsCount=0,this._ptrVert=0,this._ptrElem=0,this._idxVert=0},r.prototype.paint=function(t){var e=this._gl,i=this._prg,r=this._vertData,a=this._vertBuff,s=this._elemBuff,n=this._elemData;i.use(),i.$uniWidth=e.canvas.width,i.$uniHeight=e.canvas.height,i.$uniX=this.centerX,i.$uniY=this.centerY,i.$uniZ=this.centerZ,i.$uniZoom=this.zoom,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),i.$tex=0,i.bindAttribs(a,"attPosition","attUV"),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferSubData(e.ARRAY_BUFFER,0,r),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,n),e.drawElements(e.TRIANGLES,this._ptrElem,e.UNSIGNED_SHORT,0)},r.prototype.add=function(t,e,i,r,a,s,n,o,_,h,u,l,c,f,v,E,D,p,d,R){this._quadsCount>=this._capacity&&console.warn("Dépassement de capacité !!");var m=this._nbAttributes,T=this._ptrVert,A=this._ptrElem,b=this._idxVert,g=T;return this._vertData[T+0]=t,this._vertData[T+1]=e,this._vertData[T+2]=i,this._vertData[T+3]=r,this._vertData[T+4]=a,T+=m,this._vertData[T+0]=s,this._vertData[T+1]=n,this._vertData[T+2]=o,this._vertData[T+3]=_,this._vertData[T+4]=h,T+=m,this._vertData[T+0]=u,this._vertData[T+1]=l,this._vertData[T+2]=c,this._vertData[T+3]=f,this._vertData[T+4]=v,T+=m,this._vertData[T+0]=E,this._vertData[T+1]=D,this._vertData[T+2]=p,this._vertData[T+3]=d,this._vertData[T+4]=R,T+=m,this._ptrVert=T,this._elemData[A+0]=b+0,this._elemData[A+1]=b+1,this._elemData[A+2]=b+2,this._elemData[A+3]=b+0,this._elemData[A+4]=b+2,this._elemData[A+5]=b+3,this._idxVert+=4,this._ptrElem+=6,this._quadsCount++,g},r.prototype.addCellXY=function(t,e,i,r){var a=this.z||0,s=this._opts,n=s.cellSrcW,o=s.cellSrcH,_=s.cellDstW,h=s.cellDstH;return this.add(t,e,a,n*i,o*r,t+_,e,a,n*(1+i),o*r,t+_,e+h,a,n*(1+i),o*(1+r),t,e+h,a,n*i,o*(1+r))},r.prototype.addScaledCellXY=function(t,e,i,r,a){var s=this.z||0,n=this._opts,o=n.cellSrcW,_=n.cellSrcH,h=n.cellDstW*a,u=n.cellDstH*a;return this.add(t,e,s,o*i,_*r,t+h,e,s,o*(1+i),_*r,t+h,e+u,s,o*(1+i),_*(1+r),t,e+u,s,o*i,_*(1+r))},r.prototype.updateAtlas=function(t){var e=this._gl;if(!this._texture){var i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),this._texture=i}e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)},e.exports._=s});
>>>>>>> dc2365dbc72900a85b369c3324c4a408d0d177b1
//# sourceMappingURL=webgl.fast-sprite.js.map
require("webgl.program",function(r,e,t){function n(r,e,t){if("string"!=typeof e.vert)throw Error("[webgl.program] Missing attribute `vert` in argument `codes`!");if("string"!=typeof e.frag)throw Error("[webgl.program] Missing attribute `frag` in argument `codes`!");e=a(e,t),this.gl=r,Object.freeze(this.gl),this._typesNamesLookup=m(r);var n=r.createProgram();r.attachShader(n,h(r,e.vert)),r.attachShader(n,f(r,e.frag)),r.linkProgram(n),this.program=n,Object.freeze(this.program),this.use=function(){r.useProgram(n)},this.use(),o(this,r,n),i(this,r,n)}function o(r,e,t){var n,o,i={},a=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(n=0;n<a;n++)o=e.getActiveAttrib(t,n),o.typeName=r.getTypeName(o.type),o.length=g(e,o),o.location=e.getAttribLocation(t,o.name),console.info("item=",o),i[o.name]=o;r.attribs=i,Object.freeze(r.attribs)}function i(r,e,t){var n,o,i={},a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(n=0;n<a;n++)o=e.getActiveUniform(t,n),i[o.name]=e.getUniformLocation(t,o.name),Object.defineProperty(r,"$"+o.name,{set:s(e,o,i[o.name],r._typesNamesLookup),get:u(o),enumerable:!0,configurable:!1});r.uniforms=i,Object.freeze(r.uniforms)}function a(r,e){var t,n,o={};for(t in r)n=r[t],o[t]=n.split("\n").map(function(r){if("#include"!=r.trim().substr(0,8))return r;var t=r.indexOf("#include")+8,n=r.substr(t).trim();"'<\"".indexOf(n.charAt(0))>-1&&(n=n.substr(1,n.length-2));var o=e[n];if("string"!=typeof o)throw console.error("Include <"+n+"> not found in ",e),Error("Include not found in shader: "+n);return o}).join("\n");return o}function s(r,e,t,n){var o="_$"+e.name;switch(e.type){case r.BYTE:case r.UNSIGNED_BYTE:case r.SHORT:case r.UNSIGNED_SHORT:case r.INT:case r.UNSIGNED_INT:case r.SAMPLER_2D:return 1==e.size?function(e){r.uniform1i(t,e),this[o]=e}:function(e){r.uniform1iv(t,e),this[o]=e};case r.FLOAT:return 1==e.size?function(e){r.uniform1f(t,e),this[o]=e}:function(e){r.uniform1fv(t,e),this[o]=e};case r.FLOAT_MAT3:if(1==e.size)return function(e){r.uniformMatrix3fv(t,!1,e),this[o]=e};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_MAT3 in uniform `"+e.name+"'!'");case r.FLOAT_MAT4:if(1==e.size)return function(e){r.uniformMatrix4fv(t,!1,e),this[o]=e};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_MAT4 in uniform `"+e.name+"'!'");default:throw Error("[webgl.program.createWriter] Don't know how to deal with uniform `"+e.name+"` of type "+n[e.type]+"!")}}function u(r){var e="_$"+r.name;return function(){return this[e]}}function c(r,e,t){var n=e.createShader(r);return e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(console.log(t),console.error("An error occurred compiling the shader: "+e.getShaderInfoLog(n)),null)}function f(r,e){return c(r.FRAGMENT_SHADER,r,e)}function h(r,e){return c(r.VERTEX_SHADER,r,e)}function m(r){var e,t,n={};for(e in r)"number"==typeof(t=r[e])&&(n[t]=e);return n}function g(r,e){switch(e.type){case r.FLOAT_VEC4:return 4;case r.FLOAT_VEC3:return 3;case r.FLOAT_VEC2:return 2;case r.FLOAT:return 1;default:throw"[webgl.program:getSize] I don't know the size of the attribute '"+e.name+"' because I don't know the type "+getTypeName(e.type)+"!"}}var l=function(){function e(){return n(t,arguments)}var t={en:{},fr:{}},n=r("$").intl;return e.all=t,e}();n.prototype.getTypeName=function(r){return this._typesNamesLookup[r]};var p=(new Float32Array).BYTES_PER_ELEMENT;n.prototype.bindAttribs=function(r){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,r);var t=Array.prototype.slice.call(arguments,1),n=0;t.forEach(function(r){var e=this.attribs[r];if(!e)throw'Cannot find attribute "'+r+'"!\nIt may be not active because unused in the shader.\nAvailable attributes are: '+Object.keys(this.attribs).map(function(r){return'"'+r+'"'}).join(", ");n+=e.size*e.length*p},this);var o=0;t.forEach(function(r){var t=this.attribs[r];e.enableVertexAttribArray(t.location),e.vertexAttribPointer(t.location,t.size*t.length,e.FLOAT,!1,n,o),o+=t.size*t.length*p},this)},e.exports=n,e.exports._=l});
//# sourceMappingURL=webgl.program.js.map
require("splash",function(n,o,e){var i=function(){function o(){return i(e,arguments)}var e={en:{},fr:{}},i=n("$").intl;return o.all=e,o}();n("polyfill.promise");var t=n("dom");o.exports=function(n){var o=t.div("splash",[t.div(["TOLOKOBAN"])]);return t.add(document.body,o),new Promise(function(e,i){window.setTimeout(function(){t.addClass(o,"show")});var r=new Promise(function(o,e){var i,t,r,s={},u=0;for(i in n)u++;var a=function(){--u<=0&&o(s)};for(i in n)t=n[i],r=new Image,r.$key=i,r.src=t,r.onload=function(){s[this.$key]=this,a()},r.onerror=function(){console.error("Unable to load image: ",n[this.$key]),s[this.$key]=null,a()}});window.setTimeout(function(){r.then(function(n){e(n),t.addClass(o,"hide"),window.setTimeout(function(){t.detach(o)},300)})},1e3)})},o.exports._=i});
//# sourceMappingURL=splash.js.map
require("polyfill.promise",function(t,n,e){var r=function(){function n(){return r(e,arguments)}var e={en:{},fr:{}},r=t("$").intl;return n.all=e,n}();window.Promise||function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function e(t){return"object"==typeof t&&null!==t}function r(){}function o(){for(var t=0;t<S;t+=2){(0,D[t])(D[t+1]),D[t]=void 0,D[t+1]=void 0}S=0}function i(){}function s(){return new TypeError("You cannot resolve a promise with itself")}function u(){return new TypeError("A promises callback cannot return that same promise.")}function c(t){try{return t.then}catch(t){return K.error=t,K}}function a(t,n,e,r){try{t.call(n,e,r)}catch(t){return t}}function f(t,n,e){C(function(t){var r=!1,o=a(e,n,function(e){r||(r=!0,n!==e?_(t,e):v(t,e))},function(n){r||(r=!0,d(t,n))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,d(t,o))},t)}function l(t,n){n._state===q?v(t,n._result):t._state===F?d(t,n._result):y(n,void 0,function(n){_(t,n)},function(n){d(t,n)})}function h(t,e){if(e.constructor===t.constructor)l(t,e);else{var r=c(e);r===K?d(t,K.error):void 0===r?v(t,e):n(r)?f(t,e,r):v(t,e)}}function _(n,e){n===e?d(n,s()):t(e)?h(n,e):v(n,e)}function p(t){t._onerror&&t._onerror(t._result),m(t)}function v(t,n){t._state===I&&(t._result=n,t._state=q,0===t._subscribers.length||C(m,t))}function d(t,n){t._state===I&&(t._state=F,t._result=n,C(p,t))}function y(t,n,e,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=n,o[i+q]=e,o[i+F]=r,0===i&&t._state&&C(m,t)}function m(t){var n=t._subscribers,e=t._state;if(0!==n.length){for(var r,o,i=t._result,s=0;s<n.length;s+=3)r=n[s],o=n[s+e],r?g(e,r,o,i):o(i);t._subscribers.length=0}}function w(){this.error=null}function b(t,n){try{return t(n)}catch(t){return N.error=t,N}}function g(t,e,r,o){var i,s,c,a,f=n(r);if(f){if(i=b(r,o),i===N?(a=!0,s=i.error,i=null):c=!0,e===i)return void d(e,u())}else i=o,c=!0;e._state!==I||(f&&c?_(e,i):a?d(e,s):t===q?v(e,i):t===F&&d(e,i))}function A(t,n){try{n(function(n){_(t,n)},function(n){d(t,n)})}catch(n){d(t,n)}}function j(t,n,e,r){this._instanceConstructor=t,this.promise=new t(i,r),this._abortOnReject=e,this._validateInput(n)?(this._input=n,this.length=n.length,this._remaining=n.length,this._init(),0===this.length?v(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&v(this.promise,this._result))):d(this.promise,this._validationError())}function E(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function T(t,e){this._id=G++,this._label=e,this._state=void 0,this._result=void 0,this._subscribers=[],i!==t&&(n(t)||E(),this instanceof T||P(),A(this,t))}var k;k=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var M,O=k,S=(Date.now,Object.create,0),C=function(t,n){D[S]=t,D[S+1]=n,2===(S+=2)&&M()},R="undefined"!=typeof window?window:{},x=R.MutationObserver||R.WebKitMutationObserver,Y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,D=new Array(1e3);M="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?function(){return function(){process.nextTick(o)}}():x?function(){var t=0,n=new x(o),e=document.createTextNode("");return n.observe(e,{characterData:!0}),function(){e.data=t=++t%2}}():Y?function(){var t=new MessageChannel;return t.port1.onmessage=o,function(){t.port2.postMessage(0)}}():function(){return function(){setTimeout(o,1)}}();var I=void 0,q=1,F=2,K=new w,N=new w;j.prototype._validateInput=function(t){return O(t)},j.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},j.prototype._init=function(){this._result=new Array(this.length)};var U=j;j.prototype._enumerate=function(){for(var t=this.length,n=this.promise,e=this._input,r=0;n._state===I&&r<t;r++)this._eachEntry(e[r],r)},j.prototype._eachEntry=function(t,n){var r=this._instanceConstructor;e(t)?t.constructor===r&&t._state!==I?(t._onerror=null,this._settledAt(t._state,n,t._result)):this._willSettleAt(r.resolve(t),n):(this._remaining--,this._result[n]=this._makeResult(q,n,t))},j.prototype._settledAt=function(t,n,e){var r=this.promise;r._state===I&&(this._remaining--,this._abortOnReject&&t===F?d(r,e):this._result[n]=this._makeResult(t,n,e)),0===this._remaining&&v(r,this._result)},j.prototype._makeResult=function(t,n,e){return e},j.prototype._willSettleAt=function(t,n){var e=this;y(t,void 0,function(t){e._settledAt(q,n,t)},function(t){e._settledAt(F,n,t)})};var W=function(t,n){return new U(this,t,!0,n).promise},$=function(t,n){function e(t){_(s,t)}function r(t){d(s,t)}var o=this,s=new o(i,n);if(!O(t))return d(s,new TypeError("You must pass an array to race.")),s;for(var u=t.length,c=0;s._state===I&&c<u;c++)y(o.resolve(t[c]),void 0,e,r);return s},z=function(t,n){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var r=new e(i,n);return _(r,t),r},B=function(t,n){var e=this,r=new e(i,n);return d(r,t),r},G=0,H=T;T.all=W,T.race=$,T.resolve=z,T.reject=B,T.prototype={constructor:T,then:function(t,n,e){var r=this,o=r._state;if(o===q&&!t||o===F&&!n)return this;r._onerror=null;var s=new this.constructor(i,e),u=r._result;if(o){var c=arguments[o-1];C(function(){g(o,s,c,u)})}else y(r,s,t,n);return s},catch:function(t,n){return this.then(null,t,n)}};var J=function(){var t;"Promise"in(t="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self)&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),n(e)}()||(t.Promise=H)};J()}.call(this),n.exports._=r});
//# sourceMappingURL=polyfill.promise.js.map
require("tfw.data-binding",function(n,t,e){function r(n,t,r,o){var i="function"==typeof o;void 0===t[c]&&(t[c]={}),t[c][r]={value:o,event:new l};var u;u="function"==typeof n?function(e){e=n(e),(i||t[c][r].value!==e)&&(t[c][r].value=e,t[c][r].event.fire(e,t,r))}:function(n){(i||t[c][r].value!==n)&&(t[c][r].value=n,t[c][r].event.fire(n,t,r))};var a=o;return i||(a=function(){return t[c][r].value}),Object.defineProperty(t,r,{get:a,set:u,configurable:!1,enumerable:!0}),e.bind.bind(e,t,r)}function o(n){return n.toLowerCase()}function i(n){return n.trim()}var u=function(){function t(){return r(e,arguments)}var e={en:{}},r=n("$").intl;return t.all=e,t}();n("polyfill.string");var a=n("dom"),f=n("tfw.css").parseUnit,l=n("tfw.listeners"),c="_tfw.data-binding_",s={castFunction:function(n){return"function"!=typeof n?null:n},castArray:function(n){return Array.isArray(n)?n:null===n||void 0===n?[]:[n]},castBoolean:function(n){return"boolean"==typeof n?n:"string"==typeof n?"0"!=(n=n.trim().toLowerCase())&&"false"!=n&&"no"!=n&&"null"!=n&&"undefined"!=n:"number"==typeof n?0!==n:null},castColor:function(n){return""+n},castDate:function(n){return"number"==typeof n||"string"==typeof n?new Date(n):n instanceof Date?n:new Date},castEnum:function(n){var t=n.map(o);return function(e){if("number"==typeof e)return n[Math.floor(e)%n.length];if("string"!=typeof e)return n[0];var r=t.indexOf(e.trim().toLowerCase());return r<0&&(r=0),n[r]}},castInteger:function(n){return"number"==typeof n?Math.floor(n):"boolean"==typeof n?n?1:0:"string"==typeof n?parseInt(n):Number.NaN},castFloat:function(n){return"number"==typeof n?n:"boolean"==typeof n?n?1:0:"string"==typeof n?parseFloat(n):Number.NaN},castRegexp:function(n){if(n instanceof RegExp)return n;if("string"==typeof n&&0!=n.trim().length)try{return new RegExp(n)}catch(t){console.error("[castRegexp] /"+n+"/ ",t)}return null},castString:function(n){return"string"==typeof n?n:void 0===n||null===n?"":JSON.stringify(n)},castStringArray:function(n){return Array.isArray(n)?n:null===n||void 0===n?[]:"string"==typeof n?n.split(",").map(i):[JSON.stringify(n)]},castUnit:function(n){return n?void 0!==n.v?(n.v=parseFloat(n.v),isNaN(n.v)?{v:0,u:"px"}:("string"!=typeof n.u?n.u="px":n.u=n.u.trim().toLowerCase(),""===n.u&&(n.u="px"),{v:n.v,u:n.u})):"number"==typeof n?{v:n,u:"px"}:"string"!=typeof n?{v:0,u:"px"}:f(""+n):{v:0,u:"px"}},castValidator:function(n){if("function"==typeof n)return n;if("boolean"==typeof n)return function(){return n};if("string"==typeof n&&0!=n.trim().length)try{var t=new RegExp(n);return t.test.bind(t)}catch(t){console.error("[castValidator] /"+n+"/ ",t)}return function(){return null}}};e.fire=function(n,t,e){var r=n[t];void 0===e&&(e=r),n[c][t].value=e,n[c][t].event.fire(n[t],n,t)},e.set=function(n,t,e){void 0===n[c]&&(n[c]={}),void 0===n[c][t]&&(n[c][t]={}),n[c][t].value=e},e.get=function(n,t){if(void 0!==n[c]&&void 0!==n[c][t])return n[c][t].value},e.readOnly=function(n,t,e){"function"==typeof att?Object.defineProperty(n,t,{get:e,set:function(){},configurable:!1,enumerable:!0}):Object.defineProperty(n,t,{value:e,writtable:!1,configurable:!1,enumerable:!0})},e.prop=r.bind(null,null),e.propToggleClass=function(n,t,e,o){"string"!=typeof o&&(o="");var i={};return"string"==typeof e?i[e]=e:Array.isArray(e)?e.forEach(function(n){i[n]=n}):i=e,r(null,n,t)(function(t){var e,r;for(e in i)r=i[e],e==t?a.addClass(n.element,o+r):a.removeClass(n.element,o+r)})},e.propAddClass=function(n,t,e){return void 0===e&&(e=t),r(s.castBoolean,n,t)(function(t){t?a.addClass(n.element,e):a.removeClass(n.element,e)})},e.propRemoveClass=function(n,t,e){return void 0===e&&(e=t),r(s.castBoolean,n,t)(function(t){t?a.removeClass(n.element,e):a.addClass(n.element,e)})},e.propArray=r.bind(null,s.castArray),e.propBoolean=r.bind(null,s.castBoolean),e.propColor=r.bind(null,s.castColor),e.propDate=r.bind(null,s.castDate),e.propEnum=function(n){return r.bind(null,s.castEnum(n))},e.propFunction=r.bind(null,s.castFunction),e.propInteger=r.bind(null,s.castInteger),e.propFloat=r.bind(null,s.castFloat),e.propRegexp=r.bind(null,s.castRegexp),e.propString=r.bind(null,s.castString),e.propStringArray=r.bind(null,s.castStringArray),e.propUnit=r.bind(null,s.castUnit),e.propValidator=r.bind(null,s.castValidator),e.bind=function(n,t,e,r,o){if(void 0===n[c]||void 0===n[c][t])throw console.error(JSON.stringify(t)+" is not a bindable property!",{srcObj:n,srcAtt:t,dstObj:e,dstAtt:r,options:o}),Error(JSON.stringify(t)+" is not a bindable property!");void 0===o&&(o={}),o.value&&(o.converter=function(){return o.value});var i="function"==typeof e?e:function(n,t,i){e[r]="function"==typeof o.converter?o.converter(n):n};return n[c][t].event.add(i),o},e.extend=function(n,t,r,o){var i,u,a=JSON.parse(JSON.stringify(n));for(i in t)"$"!=i.charAt(0)&&(u=t[i],void 0===a[i]?console.error("[tfw.data-binding.extend] Undefined argument: `"+i+"`!"):a[i]=u);if(void 0!==r){for(i in t)"$"==i.charAt(0)&&Object.defineProperty(r,i,{value:t[i],writable:!1,configurable:!1,enumerable:!1});for(i in a)"$"!=i.charAt(0)&&(r[i]=a[i]);if("function"==typeof o){for(i in r[c])e.bind(r,i,o);o()}}return a},e.converters=s,t.exports._=u});
//# sourceMappingURL=tfw.data-binding.js.map
require("tfw.listeners",function(t,i,r){var n=function(){function i(){return n(r,arguments)}var r={en:{}},n=t("$").intl;return i.all=r,i}(),e=function(){this._list=[]};e.prototype.add=function(t,i){if("function"!=typeof t)return!1;this.remove(t);for(var r=0;r<this._list.length;r++)if(t===this._list[r])return!1;return this._list.push([t,i]),!0},e.prototype.remove=function(t,i){if("function"!=typeof t)return!1;for(var r=0;r<this._list.length;r++){var n=this._list[r];if(t===n[0]&&i===n[1])return this._list.splice(r,1),!0}return!1},e.prototype.clear=function(){this._list=[]},e.prototype.fire=function(){var t,i,r,n,e=[].slice.call(arguments);for(t=0;t<this._list.length;t++)if(n=this._list[t],i=n[0],r=n[1],!1===i.apply(r,e))return!1;return!0},i.exports=e,i.exports._=n});
//# sourceMappingURL=tfw.listeners.js.map
require("tfw.css",function(e,r,t){var i=function(){function r(){return i(t,arguments)}var t={en:{}},i=e("$").intl;return r.all=t,r}();t.parseUnit=function(e){for(var r,t=0,i=0;i<e.length;i++)if(r=e.charAt(i),0===t){if("-"==r||"+"==r||r>="0"&&r<="9")t=1;else if("."==r)t=2;else if(r>" ")break}else if(1==t){if("."==r)t=2;else if(r<"0"||r>"9")break}else if(2==t&&(r<"0"||r>"9"))break;var n={v:parseFloat(e.substr(0,i)),u:e.substr(i).trim().toLowerCase()};return""===n.u&&(n.u="px"),n},r.exports._=i});
//# sourceMappingURL=tfw.css.js.map
require("polyfill.string",function(r,t,n){var e=function(){function t(){return e(n,arguments)}var n={en:{}},e=r("$").intl;return t.all=n,t}();"function"!=typeof String.toLowerCase&&(String.toLowerCase=function(r){return r.toLowerCase()},String.toUpperCase=function(r){return r.toUpperCase()},String.trim=function(r){return r.trim()}),t.exports._=e});
//# sourceMappingURL=polyfill.string.js.map
require("game1.gfx",function(n,r,e){var t=function(){function r(){return t(e,arguments)}var e={en:{},fr:{}},t=n("$").intl;return r.all=e,r}();r.exports._=t});
//# sourceMappingURL=game1.gfx.js.map
require("x-widget",function(e,t,r){function n(t,r,n,i){void 0===i&&(i={});try{var d=e(r),c=new d(n),u="function"==typeof c.element?c.element():c.element,f=document.getElementById(t);return f&&f.parentNode.replaceChild(u,f),u.setAttribute("id",t),a.addClass(u,i.class||""),o(t,c),c}catch(e){throw console.error("[x-widget] Unable to create widget `"+r+"`!"),console.error("[x-widget] id = ",t,", args = ",n),Error(e)}}function i(e){var t,r=a.tag(e.elem);e.attr&&(a.att(r,e.attr),t=e.attr.id),Array.isArray(e.children)&&e.children.forEach(function(e){a.add(r,e)});var n,i,d={};if(e.prop)for(n in e.prop)i=e.prop[n],Object.defineProperty(d,n,{value:i,writable:!1,configurable:!1,enumerable:!0});return Object.defineProperty(d,"element",{value:r,writable:!1,configurable:!1,enumerable:!0}),void 0!==t&&o(t,d),d}function o(e,t){u[e]=t;var r=f[e];return void 0!==r&&window.setTimeout(function(){r.forEach(function(e){e(t)}),delete f[e]}),"function"==typeof t.element?t.element:t.element||t}var d=function(){function t(){return n(r,arguments)}var r={en:{}},n=e("$").intl;return t.all=r,t}(),a=e("dom"),c=e("tfw.data-binding"),u={},f={},l=function(e,t,r,o){return"string"==typeof e?n.call(this,e,t,r,o):i.call(this,e)};l.template=function(t){var r,n,i,d="",a={};for(r in t)n=t[r],"name"==r?d=n:"id"==r?i=n:"$"==r.charAt(0)&&(a[r.substr(1)]=n);var c=e(d),u=new c(a);return i&&o(i,u),"function"==typeof u.element?u.element():u.element||u},l.getById=function(e){if(!u[e])throw Error("[x-widget.getById()] ID not found: "+e+"!");return u[e]},l.onWidgetCreation=function(e,t){void 0===u[e]?void 0===f[e]?f[e]=[t]:f[e].push(t):window.setTimeout(function(){t(u[e])})},l.bind=function(t,r){var n,i,o,d,a,f=u[t];for(n in r)d=r[n].B,Array.isArray(d)&&d.forEach(function(e){if(void 0===(i=u[e[0]]))return void console.error("[x-widget:bind("+t+')] Trying to bind attribute "'+n+'" of widget "'+t+'" to the unexisting widget "'+e[0]+'"!');o=e[1];try{if(2==e.length)c.bind(i,o,f,n);else{var r=e[2];c.bind(i,o,function(){f[n]=r})}}catch(r){console.error("Binding error for widget `"+t+"`!",{ex:r,binding:e})}}),a=r[n].S,Array.isArray(a)&&a.forEach(function(r){var i=APP,o=r;if(Array.isArray(r)){try{i=e(r[0])}catch(e){throw console.error("[x-widget:bind] Widget `"+t+"` can't require unexistent `"+r[0]+"`: ",e),e}o=r[1]}if("function"!=typeof(o=i[o]))throw Array.isArray(r)?Error("[x-widget:bind]  Widget `"+t+"` use unexisting slot `"+r[1]+"` of module `"+r[0]+"`!"):Error("[x-widget:bind]  Widget `"+t+"` use unexisting slot `"+r+"` of main module `APP`!");try{c.bind(f,n,o)}catch(e){console.error("Binding error for widget `"+t+"`!",{ex:e,dstObj:f,dstAtt:n,fct:o,slot:r})}})},t.exports=l,t.exports._=d});
//# sourceMappingURL=x-widget.js.map
